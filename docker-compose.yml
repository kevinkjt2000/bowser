version: '2.1'
services:
  bowser:
    image: 'python:3.6-alpine@sha256:89d560f87a150d83a3bce87a29b3998fdb92d0836f015f16a9b3485f4dcb647f'
    command: /bowser.pex
    environment:
      - PYTHONUNBUFFERED=1
    depends_on:
      - redis
    restart: unless-stopped
    volumes:
      - ./dist/requirements.pex:/dist/requirements.pex:ro
      - ./dist/bowser.pex:/bowser.pex:ro
      - ./token.txt:/token.txt:ro
  redis:
    image: 'redis:alpine@sha256:26cb6d6cd7ea424a78266c5a5e08e7df9919f52729a6b0e820e10597337ce9a2'
    entrypoint: redis-server --appendonly yes
    sysctls:
      - net.core.somaxconn=511
    restart: unless-stopped
    volumes:
      - ./redis-data:/data:rw
